<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://xmlns.jcp.org/jsf/core">

<h:head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>Empresa</title>
</h:head>




<h:body>

	<h:form id="form">
		<p:growl id="msgGrowl" life="15000" />
		<p:panel header="Empresas">
		</p:panel>



		<!-- _________________________________________________________________________________________________________________________________ -->
		<!-- Informações de cabeçalho da tabela -->


		<p:dataTable id="dataTable" rowsPerPageTemplate="7,15,30,50,100"
			emptyMessage="Nenhum Registro encontrado" rows="7" paginator="true"
			var="dataVar" value="#{empresaBean.listaEmpresa}"
			style=" text-align:center;">


			<f:facet name="header">

				<p:panelGrid>

					<!-- Animação de loading -->
					<p:dialog widgetVar="statusDialog" modal="true" draggable="false"
						closable="false" resizable="false" showHeader="false">
						<p:graphicImage value="/images/loading6.gif" />
					</p:dialog>

					<!-- Personalizar table -->
					<p:commandButton title="Filtrar Colunas" id="toggler" type="button"
						value="" icon="ui-icon-calculator"
						style="float:left; height: 33px; width:34px " />
					<p:columnToggler datasource="dataTable" trigger="toggler" />



					<p:ajaxStatus onstart="PF('statusDialog').show()"
						onsuccess="PF('statusDialog').hide()" />

					<!-- Atualizar table -->
					<p:commandButton value="Atualizar" icon="ui-icon-refresh"
						action="#{empresaBean.carregar()}"
						style="float:left; height:33px;"
						update=":form:dataTable :form:msgGrowl" />






					<!-- Adicionar  -->
					<p:commandButton icon="ui-icon-plus " value="Adicionar "
						style="float:left; height:33px;"
						oncomplete="PF('dialogo').show();" action="#{empresaBean.novo()}"
						update=":dialogform" />

				</p:panelGrid>
			</f:facet>


			<f:facet name="footer">
				<!--Vazio...-->
			</f:facet>

			<!-- _________________________________________________________________________________________________________________________________ -->
			<!-- Informações das Colunas -->

			<p:column headerText="Exp" width="4%">
				<!-- Expandir infos -->
				<p:rowToggler />
			</p:column>

			<p:column headerText="ID" width="11%" sortBy="#{dataVar.codigo}"
				filterBy="#{dataVar.codigo}">
				<p:outputLabel value="#{dataVar.codigo}" />
			</p:column>

			<p:column headerText="Nome" sortBy="#{dataVar.nomeEmpresa}"
				filterBy="#{dataVar.nomeEmpresa}">
				<p:outputLabel value="#{dataVar.nomeEmpresa}" />
			</p:column>

			<p:column headerText="Email" sortBy="#{dataVar.email}"
				filterBy="#{dataVar.email}">
				<p:outputLabel value="#{dataVar.email}" />
			</p:column>

			<p:column headerText="CNPJ" sortBy="#{dataVar.cnpj}"
				filterBy="#{dataVar.cnpj}">
				<p:outputLabel value="#{dataVar.cnpj}" />
			</p:column>

			<p:column headerText="Status" width="10%" sortBy="#{dataVar.status}"
				filterBy="#{dataVar.status}">
				<p:outputLabel value="#{dataVar.status}" />
			</p:column>

			<p:column headerText="Opções" width="18%">


				<!-- Editar -->
				<p:commandButton title="Editar" icon="ui-icon-pencil"
					actionListener="#{empresaBean.getinstancia}"
					update=":dialogformEditor"
					oncomplete="PF('dialogEditorPanel').show();">
					<f:attribute name="meuSelect" value="#{dataVar}" />
				</p:commandButton>

				<!-- Resetar Senha -->
				<p:commandButton title="Resetar Senha" icon="ui-icon-key "
					actionListener="#{empresaBean.getinstancia}"
					update=":dialogformSenha"
					oncomplete="PF('dialogSenhaPanel').show();">
					<f:attribute name="meuSelect" value="#{dataVar}" />
				</p:commandButton>




				<!-- Excluir -->
				<p:commandButton title="Excluir" icon="ui-icon-trash"
					actionListener="#{empresaBean.excluir}" update=":form:msgGrowl">
					<p:confirm header="Confirmação"
						message="Deseja excluir o usuário ?" icon="ui-icon-alert" />
					<f:attribute name="meuSelect" value="#{dataVar}" />
				</p:commandButton>

				<!-- Dialogo Global -->
				<p:confirmDialog global="true">
					<p:commandButton value="sim" type="button"
						styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
					<p:commandButton value="não" type="button"
						styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
				</p:confirmDialog>

			</p:column>


			<!-- _________________________________________________________________________________________________________________________________ -->
			<!-- Informações após expandir linha -->


			<p:rowExpansion styleClass=" width=37%">

				<p:panelGrid columns="1" columnClasses="label,value"
					style="text-align:left;">

					<h:outputText value="Senha: #{dataVar.senha}" />
					<h:outputText value="Seguimento: #{dataVar.seguimento}" />
					<h:inputTextarea readonly="true"  rows="7" cols="80" value="Endereço: #{dataVar.endereco.toString}" />
					<p:inputTextarea readonly="true" rows="7" cols="80"
						value="Descrição: #{dataVar.descricao}" />

				</p:panelGrid>

				<!-- <p:separator style="border: 2px solid #999966; border-radius: 100px/9px; background-color:  #6666ff; height:10px;"> </p:separator>  -->
				<p:separator
					style=" height:7px;border-radius: 100px/9px; background-color:#ffffff"></p:separator>
				<p:separator style=" height:10px;background-color:#e6e6ff"></p:separator>
			</p:rowExpansion>

		</p:dataTable>
	</h:form>


	<!-- _________________________________________________________________________________________________________________________________ -->
	<!--   Dialog do Adicionar             -->


	<!-- draggable = false ou true "mover a janela suspensa"| 
     resizable=false ou true"mudar o tamanho a janela suspensa" |
     modal=false ou true "clicar foda da janela suspensa"|
     closable="true?" 'controla o botão fechar do dialogo'-->

	<p:dialog header="Adicionar Empresa" widgetVar="dialogo" modal="true"
		responsive="true">

		<h:form id="dialogform">



			<p:layout onResize="false"
				style="min-width:850px; min-height:500px; max-width:850px; max-height:500px; ">
				<p:growl id="global" life="5000" />



				<!-- _________________________________________________________________________________________________________________________________ -->

				<!-- West -->

				<p:layoutUnit id="West" position="west" size="400" minSize="210"
					maxSize="500">

					<h:panelGrid columns="2" id="dialogpanel"> 


						<p:outputLabel value="Status: " />
						<p:selectBooleanButton onLabel="Ativado" offLabel="Desativado"
							value="#{empresaBean.empresa.status}" required="true"
							requiredMessage="Verificar campo Status">
						</p:selectBooleanButton>

						<p:outputLabel value="Nome da Empresa: ">
						</p:outputLabel>
						<p:inputText id="nome" maxlength="50" size="25" label="nome"
							value="#{empresaBean.empresa.nomeEmpresa}" required="true"
							requiredMessage="Verificar campo Nome"
							validatorMessage="Erro de validação: Dígite o nome corretamente">
							<f:validateLength minimum="2" />

						</p:inputText>


						<p:outputLabel value="Seguimento: " />
						<p:inputText id="seguimento" maxlength="50" size="25"
							value="#{empresaBean.empresa.seguimento}" required="false"
							requiredMessage="Verificar campo seguimento"
							validatorMessage="Erro de validação: o comprimento é menor do que o mínimo permitido. '2 dígitos' ">
							<f:validateLength minimum="2" disabled="true" />
						</p:inputText>


						<p:outputLabel value="CNPJ: " />
						<p:inputMask mask="99.999.999/9999-99" id="cnpj" maxlength="50"
							size="25" value="#{empresaBean.empresa.cnpj}" required="false"
							requiredMessage="Verificar campo CNPJ"
							validatorMessage="Erro de validação: o comprimento é menor do que o mínimo permitido. '14 dígitos' ">
							<f:validateLength minimum="14" disabled="true" />
						</p:inputMask>


						<p:outputLabel value="Descrição: " />
						<p:inputTextarea id="descricao" rows="3" cols="24"
							value="#{empresaBean.empresa.descricao}">
						</p:inputTextarea>


						<p:separator style="border: 1px solid #e6e6ff; height: 1px;"></p:separator>
						<p:separator style="border: 1px solid #e6e6ff; height: 1px;"></p:separator>


						<p:outputLabel value="E-mail:" />
						<p:inputText id="email" maxlength="50" size="25"
							value="#{empresaBean.empresa.email}" required="false"
							requiredMessage="Verificar campo E-Mail"
							validatorMessage="Erro de validação: o e-mail não é válido ">
							<f:validateRegex disabled="true" for="email"
								validatorMessage="Erro de validação: o endereço de e-mail não é válido "
								pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$" />
						</p:inputText>



						<p:outputLabel value="Digite uma Senha:" />
						<p:password id="senha" match="confirmar" maxlength="16" size="25"
							feedback="true" inline="true"
							value="#{empresaBean.empresa.senha}" required="true"
							requiredMessage="Verificar campo Senha"
							validatorMessage="Erro de validação: o comprimento é menor do que o mínimo permitido. '4 dígitos' ">
							<f:validateLength minimum="4" />
						</p:password>



						<p:outputLabel value="Confirmar senha:" required="true" />
						<p:password id="confirmar" maxlength="16" size="25"
							value="#{empresaBean.empresa.senha}" required="true"
							requiredMessage="Verificar campo Confirmar Senha"
							validatorMessage="Erro de validação: o comprimento é menor do que o mínimo permitido. '4 dígitos' ">
							<f:validateLength minimum="4" />
						</p:password>



					</h:panelGrid>

				</p:layoutUnit>



				<!-- _________________________________________________________________________________________________________________________________ -->

				<!-- Center -->
				<p:layoutUnit id="Center" position="center" closable="true"
					collapsible="true" size="400" minSize="210" maxSize="500">


					<h:panelGrid columns="2" id="dialogpanel2"> 


						<p:outputLabel value="Estado: " />
						<p:selectOneMenu filter="true"
							value="#{empresaBean.endereco.estado}"
							converter="omnifaces.SelectItemsConverter" required="true"
							requiredMessage="Informe o Estado corretamente">
							<f:selectItem itemDisabled="true" noSelectionOption="true"
								itemLabel="Selecione o Estado" />
							<f:selectItems value="#{empresaBean.listaEstado}" var="estado"
								itemValue="#{estado.codigo}"
								itemLabel="#{estado.nome} - #{estado.sigla}" />
						</p:selectOneMenu>

						<p:outputLabel value="Cidade: " />
						<p:selectOneMenu filter="true"
							value="#{empresaBean.endereco.cidade}"
							converter="omnifaces.SelectItemsConverter" required="true"
							requiredMessage="Informe a Cidade corretamente">
							<f:selectItem itemDisabled="true" noSelectionOption="true"
								itemLabel="Selecione a Cidade" />
							<f:selectItems value="#{empresaBean.listaCidade}" var="cidade"
								itemValue="#{cidade.codigo}" itemLabel="#{cidade.nome}" />
						</p:selectOneMenu>

						<p:outputLabel value="Rua:">
						</p:outputLabel>

						<p:inputText id="rua" size="30" label="rua"
							value="#{empresaBean.endereco.rua}">
						</p:inputText>


						<p:outputLabel value="Número: "></p:outputLabel>
						<p:inputNumber value="#{empresaBean.endereco.numero}"
							required="false" requiredMessage="Preencha o campo Número"></p:inputNumber>

						<p:outputLabel value="Bairro:"></p:outputLabel>
						<p:inputText value="#{empresaBean.endereco.bairro}"
							required="false" requiredMessage="Preencha o campo bairro">
						</p:inputText>




						<p:outputLabel value="Complemento: " />
						<p:inputText id="complemento" size="30" label="complemento"
							value="#{empresaBean.endereco.complemento}" required="true"
							requiredMessage="Preencha o campo complemento">
						</p:inputText>




						<p:outputLabel value="CEP: " />
						<p:inputMask mask="99999-999" id="cep"
							value="#{empresaBean.endereco.cep}" required="false"
							requiredMessage="Preencha o campo CEP">
						</p:inputMask>




						<p:outputLabel value="Telefone: " />
						<p:inputMask mask="(99) 9999-9999" id="tel"
							value="#{empresaBean.endereco.telefone}" required="false"
							requiredMessage="Preencha o campo telefone">
							<f:validateLength minimum="8" maximum="18"></f:validateLength>
						</p:inputMask>



						<p:outputLabel value="Celular: " />
						<p:inputMask mask="(99) 9 9999-9999" id="cel"
							value="#{empresaBean.endereco.celular}" required="false"
							requiredMessage="Preencha o campo celular">
							<f:validateLength minimum="10" maximum="17"></f:validateLength>
						</p:inputMask>


					</h:panelGrid>



				</p:layoutUnit>




				<!-- _________________________________________________________________________________________________________________________________ -->

				<!-- South -->
				<p:layoutUnit id="South" position="south" resizable="true"
					closable="true" collapsible="true" size="50">

					<h:panelGrid columns="2">

						<p:commandButton value="Salvar"
							actionListener="#{empresaBean.salvar}" validateClient="true"
							update=":dialogform:">
						</p:commandButton>


						<p:commandButton value="Fechar"
							actionListener="#{empresaBean.fechar}"
							oncomplete="PF('dialogo').hide();" />

					</h:panelGrid>

				</p:layoutUnit>


			</p:layout>



		</h:form>

	</p:dialog>


	<!-- _________________________________________________________________________________________________________________________________ -->
	<!-- Dialogo do Editar -->


	<p:dialog header="Editar Usuário" widgetVar="dialogEditorPanel"
		modal="true" responsive="true">

		<h:form id="dialogformEditor">

			<p:messages id="msgdialogEditor" autoUpdate="true" globalOnly="true"
				closable="true" />
			<h:panelGrid columns="3" id="dialogEditorPanel">

				<p:outputLabel value="Status: " />
				<p:selectBooleanButton onLabel="Ativado" offLabel="Desativado"
					value="#{empresaBean.empresa.status}" required="true"
					requiredMessage="Verificar campo Status">
				</p:selectBooleanButton>
				<p></p>



				<p:outputLabel value="Nome da Empresa: ">
				</p:outputLabel>
				<p:inputText id="nome" maxlength="50" size="25" label="nome"
					value="#{empresaBean.empresa.nomeEmpresa}" required="true"
					requiredMessage="Verificar campo Nome"
					validatorMessage="Erro de validação: Dígite o nome corretamente">
					<f:validateLength minimum="2" />

				</p:inputText>
				<p:message for="nome" />


				<p:outputLabel value="Seguimento: " />
				<p:inputText id="seguimento" maxlength="50" size="25"
					value="#{empresaBean.empresa.seguimento}" required="false"
					requiredMessage="Verificar campo seguimento"
					validatorMessage="Erro de validação: o comprimento é menor do que o mínimo permitido. '2 dígitos' ">
					<f:validateLength minimum="2" disabled="true" />
				</p:inputText>
				<p:message for="seguimento" />

				<p:outputLabel value="CNPJ: " />
				<p:inputMask mask="99.999.999/9999-99" id="cnpj" maxlength="50"
					size="25" value="#{empresaBean.empresa.cnpj}" required="false"
					requiredMessage="Verificar campo CNPJ"
					validatorMessage="Erro de validação: o comprimento é menor do que o mínimo permitido. '14 dígitos' ">
					<f:validateLength minimum="14" disabled="true" />
				</p:inputMask>
				<p:message for="cnpj" />


				<p:outputLabel value="Descrição: " />
				<p:inputTextarea id="descricao" rows="5"
					value="#{empresaBean.empresa.descricao}">
				</p:inputTextarea>
				<p:message for="seguimento" />



				<p:separator style="border: 1px solid #e6e6ff; height: 1px;"></p:separator>
				<p:separator style="border: 1px solid #e6e6ff; height: 1px;"></p:separator>
				<p></p>




				<p:outputLabel value="E-mail:" />
				<p:inputText id="email" maxlength="50" size="25"
					value="#{empresaBean.empresa.email}" required="false"
					requiredMessage="Verificar campo E-Mail"
					validatorMessage="Erro de validação: o e-mail não é válido ">
					<f:validateRegex disabled="true" for="email"
						validatorMessage="Erro de validação: o endereço de e-mail não é válido "
						pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$" />
				</p:inputText>
				<p:message for="email" />




			</h:panelGrid>



			<h:panelGrid columns="2">


				<p:commandButton value="Salvar"
					actionListener="#{empresaBean.editar}" validateClient="true"
					update=":dialogformEditor:dialogEditorPanel: ">
				</p:commandButton>
				<p:commandButton value="Fechar"
					actionListener="#{empresaBean.fechar}"
					oncomplete="PF('dialogEditorPanel').hide();" />

			</h:panelGrid>

		</h:form>

	</p:dialog>


	<!-- _________________________________________________________________________________________________________________________________ -->
	<!-- Dialogo do Reset de senha -->


	<p:dialog header="Resetar senha" widgetVar="dialogSenhaPanel"
		modal="true" responsive="true">

		<h:form id="dialogformSenha">

			<p:messages id="msgdialogSenha" autoUpdate="true" closable="true" />

			<h:panelGrid columns="2" id="dialogSenhaPanelGrid">


				<p:outputLabel value="Nome da Empresa: " />
				<p:inputText readonly="true" label="nome"
					value="#{empresaBean.empresa.nomeEmpresa}" size="25" />

				<p:outputLabel value="CNPJ: " />
				<p:inputText readonly="true" label="cnpj"
					value="#{empresaBean.empresa.cnpj}" size="25" />


				<p:outputLabel value="E-mail: " />
				<p:inputText readonly="true" label="email"
					value="#{empresaBean.empresa.email}" size="25" />


				<p:separator style="border: 1px solid #e6e6ff; height: 1px;"></p:separator>
				<p:separator style="border: 1px solid #e6e6ff; height: 1px;"></p:separator>


				<p:outputLabel value="Digite uma Senha:" />
				<p:password id="senha" match="confirmar" maxlength="16" size="25"
					feedback="true" inline="true" value="#{empresaBean.empresa.senha}"
					required="true" requiredMessage="Verificar campo Senha"
					validatorMessage="Erro de validação: As senhas não conferem, ou o comprimento é menor do que o mínimo permitido. ">
					<f:validateLength minimum="4" />
				</p:password>



				<p:outputLabel value="Confirmar senha:" required="true" />
				<p:password id="confirmar" maxlength="16" size="25"
					value="#{empresaBean.empresa.senha}" required="true"
					requiredMessage="Verificar campo Confirmar Senha"
					validatorMessage="Erro de validação: o comprimento é menor do que o mínimo permitido. '4 dígitos' ">
					<f:validateLength minimum="4" />
				</p:password>





			</h:panelGrid>





			<h:panelGrid columns="2">

				<p:commandButton value="Salvar"
					actionListener="#{empresaBean.editarSenha}"
					update=":dialogformSenha:msgdialogSenha:" />
				<p:commandButton value="Fechar"
					actionListener="#{empresaBean.fechar}"
					oncomplete="PF('dialogSenhaPanel').hide();" />

			</h:panelGrid>

		</h:form>

	</p:dialog>




</h:body>
</html>